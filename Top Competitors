SELECT
    h.hacker_id,
    h.name
FROM Hackers h
LEFT JOIN (
    SELECT
        s.hacker_id as hacker_id,
        COUNT(DISTINCT s.submission_id) as maxScores
    FROM Submissions s
    LEFT JOIN Challenges c ON c.challenge_id = s.challenge_id
    LEFT JOIN Difficulty d ON d.difficulty_level = c.difficulty_level
    WHERE s.score = d.score
    GROUP BY s.hacker_id
) m ON m.hacker_id = h.hacker_id
WHERE m.maxScores > 1
ORDER BY m.maxScores DESC, h.hacker_id ASC
