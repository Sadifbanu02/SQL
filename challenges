SELECT h.hacker_id, h.name, COUNT(c.challenge_id) AS total_challenges
FROM Hackers h
JOIN Challenges c
  ON h.hacker_id = c.hacker_id
GROUP BY h.hacker_id, h.name
HAVING 
    COUNT(c.challenge_id) = (
        SELECT MAX(ch_count)
        FROM (
            SELECT COUNT(challenge_id) AS ch_count
            FROM Challenges
            GROUP BY hacker_id
        ) AS sub
    )
    OR COUNT(c.challenge_id) IN (
        SELECT ch_count
        FROM (
            SELECT COUNT(challenge_id) AS ch_count
            FROM Challenges
            GROUP BY hacker_id
        ) AS sub2
        GROUP BY ch_count
        HAVING COUNT(ch_count) = 1
    )
ORDER BY total_challenges DESC, h.hacker_id;
